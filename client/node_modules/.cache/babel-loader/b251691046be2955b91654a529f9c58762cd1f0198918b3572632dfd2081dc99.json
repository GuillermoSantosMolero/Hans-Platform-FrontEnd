{"ast":null,"code":"import _regeneratorRuntime from\"C:/VISILAB/Hans/HANS-Platform/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/VISILAB/Hans/HANS-Platform/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/VISILAB/Hans/HANS-Platform/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{React,useState}from\"react\";import Button from'@mui/material/Button';import TextField from'@mui/material/TextField';import Box from'@mui/material/Box';import Typography from'@mui/material/Typography';import Container from'@mui/material/Container';import Collapse from'@mui/material/Collapse';import Alert from'@mui/material/Alert';import AlertTitle from'@mui/material/AlertTitle';import IconButton from'@mui/material/IconButton';import CloseIcon from'@mui/icons-material/Close';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function AdminLogin(_ref){var _ref$username=_ref.username,username=_ref$username===void 0?null:_ref$username,_ref$password=_ref.password,password=_ref$password===void 0?null:_ref$password,_ref$status=_ref.status,status=_ref$status===void 0?null:_ref$status,_ref$onJoinSession=_ref.onJoinSession,onJoinSession=_ref$onJoinSession===void 0?function(){}:_ref$onJoinSession;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var joinSession=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var formData,username,password;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();// Recogemos el elemento que genero el evento en este caso el formulario\nformData=new FormData(event.currentTarget);// Recoge el valor asociado al id del elemento\nusername=formData.get('username');password=formData.get('password');//Saca error si el id de la sesión no es numérico\n_context.next=6;return fetch(\"/api/admin/login\",{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({user:username,pass:password})}).then(function(res){if(res.status===200){res.json().then(function(data){onJoinSession(username,password,data.status);});}else{res.text().then(function(msg){return setError({title:\"Incorrect credentials\",msg:msg});});}}).catch(function(error){setError({title:\"Unable to send join request\",msg:error});});case 6:case\"end\":return _context.stop();}},_callee);}));return function joinSession(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Container,{component:\"main\",maxWidth:\"xs\",children:/*#__PURE__*/_jsxs(Box,{sx:{marginTop:8,display:'flex',flexDirection:'column',alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h4\",children:\"Admin Login\"}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:joinSession,noValidate:true,sx:{mt:1},children:[/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"username\",label:\"User name\",name:\"username\",autoComplete:\"username\",defaultValue:username,autoFocus:true}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,type:\"password\",fullWidth:true,id:\"password\",name:\"password\",label:\"Password\",inputProps:{inputMode:'password'}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2},children:\"Join\"}),/*#__PURE__*/_jsx(Collapse,{in:error!==null,children:/*#__PURE__*/_jsxs(Alert,{severity:\"error\",action:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"close\",color:\"inherit\",size:\"small\",onClick:function onClick(){setError(null);},children:/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"inherit\"})}),children:[/*#__PURE__*/_jsx(AlertTitle,{children:/*#__PURE__*/_jsx(\"b\",{children:error?error.title:\"Error\"})}),error&&error.msg]})})]})]})});}","map":{"version":3,"names":["React","useState","Button","TextField","Box","Typography","Container","Collapse","Alert","AlertTitle","IconButton","CloseIcon","AdminLogin","username","password","status","onJoinSession","error","setError","joinSession","event","preventDefault","formData","FormData","currentTarget","get","fetch","method","headers","body","JSON","stringify","user","pass","then","res","json","data","text","msg","title","catch","marginTop","display","flexDirection","alignItems","mt","inputMode","mb"],"sources":["C:/VISILAB/Hans/HANS-Platform/client/src/components/admin/AdminLogin.jsx"],"sourcesContent":["import { React, useState } from \"react\";\r\n\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport Box from '@mui/material/Box';\r\nimport Typography from '@mui/material/Typography';\r\nimport Container from '@mui/material/Container';\r\nimport Collapse from '@mui/material/Collapse';\r\nimport Alert from '@mui/material/Alert';\r\nimport AlertTitle from '@mui/material/AlertTitle';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\n\r\n\r\nexport default function AdminLogin({ username = null, password=null, status=null, onJoinSession=()=>{} }) {\r\n  const [error, setError] = useState(null);\r\n\r\n  const joinSession = async (event) => {\r\n    event.preventDefault();\r\n    // Recogemos el elemento que genero el evento en este caso el formulario\r\n    const formData = new FormData(event.currentTarget);\r\n    // Recoge el valor asociado al id del elemento\r\n    const username = formData.get('username');\r\n    const password = formData.get('password');\r\n    //Saca error si el id de la sesión no es numérico\r\n\r\n    await fetch(\r\n      `/api/admin/login`,\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(\r\n            {user: username, \r\n            pass: password}\r\n            )\r\n      }\r\n    ).then(res => {\r\n      if(res.status === 200) {\r\n        res.json().then(data => {\r\n          onJoinSession(username, password, data.status);\r\n        });\r\n      } else {\r\n        res.text().then(msg =>\r\n          setError({title: \"Incorrect credentials\", msg: msg})\r\n        );\r\n      }\r\n    }).catch(error => {\r\n      setError({title: \"Unable to send join request\", msg: error});\r\n    });\r\n  };\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Box\r\n        sx={{\r\n          marginTop: 8,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n        }}\r\n      >\r\n        <Typography component=\"h1\" variant=\"h4\">\r\n          Admin Login\r\n        </Typography>\r\n        <Box component=\"form\" onSubmit={joinSession} noValidate sx={{ mt: 1 }}>\r\n          <TextField\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"username\"\r\n            label=\"User name\"\r\n            name=\"username\"\r\n            autoComplete=\"username\"\r\n            defaultValue={username}\r\n            autoFocus\r\n          />\r\n          <TextField\r\n            margin=\"normal\"\r\n            required\r\n            type=\"password\"\r\n            fullWidth\r\n            id=\"password\"\r\n            name=\"password\"\r\n            label=\"Password\"\r\n            inputProps={{ inputMode: 'password'}}\r\n          />\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            sx={{ mt: 3, mb: 2 }}\r\n          >\r\n            Join\r\n          </Button>\r\n          <Collapse in={error !== null}>\r\n            <Alert\r\n              severity=\"error\"\r\n              action={\r\n                <IconButton\r\n                  aria-label=\"close\"\r\n                  color=\"inherit\"\r\n                  size=\"small\"\r\n                  onClick={() => {\r\n                    setError(null);\r\n                  }}\r\n                >\r\n                  <CloseIcon fontSize=\"inherit\" />\r\n                </IconButton>\r\n              }\r\n            >\r\n              <AlertTitle><b>{error ?  error.title : \"Error\"}</b></AlertTitle>\r\n              {error && error.msg}\r\n            </Alert>\r\n          </Collapse>\r\n        </Box>\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
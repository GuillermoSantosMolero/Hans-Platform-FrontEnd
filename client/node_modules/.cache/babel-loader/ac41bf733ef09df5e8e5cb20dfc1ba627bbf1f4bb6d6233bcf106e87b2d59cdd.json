{"ast":null,"code":"import _regeneratorRuntime from\"C:/VISILAB/Hans/HANS-Platform/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/VISILAB/Hans/HANS-Platform/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/VISILAB/Hans/HANS-Platform/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{React,useState}from\"react\";import Button from'@mui/material/Button';import TextField from'@mui/material/TextField';import Box from'@mui/material/Box';import Typography from'@mui/material/Typography';import Container from'@mui/material/Container';import Collapse from'@mui/material/Collapse';import Alert from'@mui/material/Alert';import AlertTitle from'@mui/material/AlertTitle';import IconButton from'@mui/material/IconButton';import CloseIcon from'@mui/icons-material/Close';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SessionLogin(_ref){var _ref$username=_ref.username,username=_ref$username===void 0?null:_ref$username,_ref$onJoinSession=_ref.onJoinSession,onJoinSession=_ref$onJoinSession===void 0?function(){}:_ref$onJoinSession;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var joinSession=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var formData,sessionId;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();// Recogemos el elemento que genero el evento en este caso el formulario\nformData=new FormData(event.currentTarget);// Recoge el valor asociado al id del elemento\nsessionId=formData.get('session-id');//Saca error si el id de la sesión no es numérico\nif(!(!sessionId.trim().length||isNaN(sessionId))){_context.next=6;break;}setError({title:\"Invalid session ID\",msg:\"Only integer numbers are valid\"});return _context.abrupt(\"return\");case 6:_context.next=8;return fetch(\"http://172.24.111.51:80/api/session/\".concat(sessionId,\"/participants\"),{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({user:formData.get('username')})}).then(function(res){if(res.status===200){res.json().then(function(data){onJoinSession(data.username,data.id,sessionId);});}else{res.text().then(function(msg){return setError({title:\"Unable to join session\",msg:msg});});}}).catch(function(error){setError({title:\"Unable to send join request\",msg:error});});case 8:case\"end\":return _context.stop();}},_callee);}));return function joinSession(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Container,{component:\"main\",maxWidth:\"xs\",children:/*#__PURE__*/_jsxs(Box,{sx:{marginTop:8,display:'flex',flexDirection:'column',alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h4\",children:\"Join session\"}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:joinSession,noValidate:true,sx:{mt:1},children:[/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"username\",label:\"User name\",name:\"username\",autoComplete:\"username\",defaultValue:username,autoFocus:true}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"session-id\",name:\"session-id\",label:\"Session ID\",inputProps:{inputMode:'numeric',pattern:'[0-9]*'}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2},children:\"Join\"}),/*#__PURE__*/_jsx(Collapse,{in:error!==null,children:/*#__PURE__*/_jsxs(Alert,{severity:\"error\",action:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"close\",color:\"inherit\",size:\"small\",onClick:function onClick(){setError(null);},children:/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"inherit\"})}),children:[/*#__PURE__*/_jsx(AlertTitle,{children:/*#__PURE__*/_jsx(\"b\",{children:error?error.title:\"Error\"})}),error&&error.msg]})})]})]})});}","map":{"version":3,"names":["React","useState","Button","TextField","Box","Typography","Container","Collapse","Alert","AlertTitle","IconButton","CloseIcon","SessionLogin","username","onJoinSession","error","setError","joinSession","event","preventDefault","formData","FormData","currentTarget","sessionId","get","trim","length","isNaN","title","msg","fetch","method","headers","body","JSON","stringify","user","then","res","status","json","data","id","text","catch","marginTop","display","flexDirection","alignItems","mt","inputMode","pattern","mb"],"sources":["C:/VISILAB/Hans/HANS-Platform/client/src/components/SessionLogin.jsx"],"sourcesContent":["import { React, useState } from \"react\";\r\n\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport Box from '@mui/material/Box';\r\nimport Typography from '@mui/material/Typography';\r\nimport Container from '@mui/material/Container';\r\nimport Collapse from '@mui/material/Collapse';\r\nimport Alert from '@mui/material/Alert';\r\nimport AlertTitle from '@mui/material/AlertTitle';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\n\r\n\r\nexport default function SessionLogin({ username = null, onJoinSession=()=>{} }) {\r\n  const [error, setError] = useState(null);\r\n\r\n  const joinSession = async (event) => {\r\n    event.preventDefault();\r\n    // Recogemos el elemento que genero el evento en este caso el formulario\r\n    const formData = new FormData(event.currentTarget);\r\n    // Recoge el valor asociado al id del elemento\r\n    const sessionId = formData.get('session-id');\r\n    //Saca error si el id de la sesión no es numérico\r\n    if(!sessionId.trim().length || isNaN(sessionId)) {\r\n      setError({title: \"Invalid session ID\", msg: \"Only integer numbers are valid\"});\r\n      return;\r\n    }\r\n\r\n    await fetch(\r\n      `http://172.24.111.51:80/api/session/${sessionId}/participants`,\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({user: formData.get('username')})\r\n      }\r\n    ).then(res => {\r\n      if(res.status === 200) {\r\n        res.json().then(data => {\r\n          onJoinSession(data.username, data.id, sessionId);\r\n        });\r\n      } else {\r\n        res.text().then(msg =>\r\n          setError({title: \"Unable to join session\", msg: msg})\r\n        );\r\n      }\r\n    }).catch(error => {\r\n      setError({title: \"Unable to send join request\", msg: error});\r\n    });\r\n  };\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Box\r\n        sx={{\r\n          marginTop: 8,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n        }}\r\n      >\r\n        <Typography component=\"h1\" variant=\"h4\">\r\n          Join session\r\n        </Typography>\r\n        <Box component=\"form\" onSubmit={joinSession} noValidate sx={{ mt: 1 }}>\r\n          <TextField\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"username\"\r\n            label=\"User name\"\r\n            name=\"username\"\r\n            autoComplete=\"username\"\r\n            defaultValue={username}\r\n            autoFocus\r\n          />\r\n          <TextField\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"session-id\"\r\n            name=\"session-id\"\r\n            label=\"Session ID\"\r\n            inputProps={{ inputMode: 'numeric', pattern: '[0-9]*' }}\r\n          />\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            sx={{ mt: 3, mb: 2 }}\r\n          >\r\n            Join\r\n          </Button>\r\n          <Collapse in={error !== null}>\r\n            <Alert\r\n              severity=\"error\"\r\n              action={\r\n                <IconButton\r\n                  aria-label=\"close\"\r\n                  color=\"inherit\"\r\n                  size=\"small\"\r\n                  onClick={() => {\r\n                    setError(null);\r\n                  }}\r\n                >\r\n                  <CloseIcon fontSize=\"inherit\" />\r\n                </IconButton>\r\n              }\r\n            >\r\n              <AlertTitle><b>{error ?  error.title : \"Error\"}</b></AlertTitle>\r\n              {error && error.msg}\r\n            </Alert>\r\n          </Collapse>\r\n        </Box>\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}